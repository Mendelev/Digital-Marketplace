template:
  name: Deploy Services
  identifier: Deploy_Services
  versionLabel: version1
  type: Pipeline
  orgIdentifier: default
  tags: {}
  spec:
    variables:
      - name: serviceName
        type: String
        description: "Service directory name (REQUIRED)"
        required: true
        value: <+input>.allowedValues(auth-service,user-service,catalog-service,cart-service,order-service,payment-service,inventory-service,shipping-service,search-service)
      - name: artifactId
        type: String
        description: "Maven artifactId (usually same as serviceName)"
        required: true
        value: <+input>.executionInput()
      - name: jfrogBaseUrl
        type: String
        description: "JFrog Artifactory base URL"
        required: true
        value: <+input>.default(https://trialq6tyqg.jfrog.io/artifactory).executionInput()
      - name: jfrogRepoName
        type: String
        description: "JFrog repository name"
        required: true
        value: <+input>.default(libs-snapshot-local).executionInput()
      - name: dynamicVersion
        type: String
        description: "Dynamic version (auto-generated)"
        required: false
        value: ""
    properties:
      ci:
        codebase:
          connectorRef: account.Github_OAuth_1766587643054
          repoName: Mendelev/Digital-Marketplace
          build: <+input>
    stages:
      - stage:
          name: Build
          identifier: Build
          description: ""
          type: CI
          spec:
            cloneCodebase: true
            caching:
              enabled: true
              override: true
            buildIntelligence:
              enabled: true
            platform:
              os: Linux
              arch: Amd64
            runtime:
              type: Docker
              spec: {}
            execution:
              steps:
                - step:
                    name: Generate_Maven_Settings
                    identifier: Generate_Maven_Settings
                    template:
                      templateRef: org.Generate_Maven_Settings
                      versionLabel: version1
                - step:
                    name: Deploy_to_Artifactory
                    identifier: Deploy_to_Artifactory
                    template:
                      templateRef: org.Deploy_to_Artifactory
                      versionLabel: version1
